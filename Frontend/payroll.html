<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Junstyle.css">
    <title>Payroll</title>
</head>
<body>

    <div class="header-main"><!--this is for the top footer of the page-->
        <div class="logo">
          <img src="images/WhiteLogo.png" alt="Logo">
        </div>
        <div class = "Title">
          <div class="title-container">
              <div class="shop-name">Joe's AutoShop</div>
              <div class="tagline">If it ain't Joe don't fix it!</div>
          </div>
            <div class="account-box-left">
                <button onclick="location.href='index.html'">Log Out</button>
                <button onclick="location.href='adminMain.html'">Main Page</button>
            </div>
        </div>
      </div>

      <div class="wrapper">
        <div>
            <h1>Administator</h1>

            <h1>&nbsp;</h1><!--Used to space the wrappers-->

        </div>
    
        <div>
            <p>Employee Payroll</p>
            <table bgcolor="black" width="1000">
                <tr bgcolor="darkgray">
                    <th>Employee</th>
                    <th>Hours</th>
                    <th>Overtime</th>
                    <th>Rate</th>
                    <th>Wages</th>
                </tr>
            </table>
            <h1>&nbsp;</h1><!--Used to space the wrappers-->
            <h1>&nbsp;</h1><!--Used to space the wrappers-->
            <h1>&nbsp;</h1><!--Used to space the wrappers-->
            <h1>&nbsp;</h1><!--Used to space the wrappers-->
        </div>
      </div>
      <script>
        window.addEventListener('DOMContentLoaded', async () => {
          try {
            const res = await fetch('/api/payroll');
            const data = await res.json();
        
            const table = document.querySelector('table');
        
            data.forEach(emp => {
              const row = document.createElement('tr');
              row.setAttribute('bgcolor', 'gray');
              row.setAttribute('align', 'center');
              row.innerHTML = `
                <td>${emp.name}</td>
<td>${Math.floor(emp.minutes / 60)}h ${Math.round(emp.minutes % 60)}m</td>
                <td>${emp.overtime}</td>
                <td>$${emp.rate}</td>
                <td>$${emp.total.toFixed(2)}</td>
              `;
              table.appendChild(row);
            });
          } catch (err) {
            console.error("Failed to load payroll data:", err);
          }
        });
        </script>        
</body>
</html>